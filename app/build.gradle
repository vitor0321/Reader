apply plugin: 'com.android.application'
apply plugin: 'org.jetbrains.kotlin.android'
apply plugin: 'com.google.gms.google-services'
apply plugin: 'kotlin-kapt'
apply plugin: 'kotlin-android'
apply plugin: "com.google.devtools.ksp"

android {
    compileSdk 33
    namespace 'com.walcker.reader'

    android {
        defaultConfig {
            applicationId 'com.walcker.reader'
        }
    }

    ksp {
        arg("lyricist.internalVisibility", "true")
    }
    defaultConfig {
        minSdk 24
        targetSdk 33
        versionCode 1
        versionName "1.0"

        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
        vectorDrawables {
            useSupportLibrary true
        }
        multiDexEnabled true
    }
    buildTypes {
        debug {
            minifyEnabled false
            sourceSets {
                main.java.srcDirs += 'build/generated/ksp/debug/kotlin/'
            }
        }
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
            sourceSets {
                main.java.srcDirs += 'build/generated/ksp/release/kotlin/'
            }
        }
    }
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_11
        targetCompatibility JavaVersion.VERSION_11
    }
    kotlinOptions {
        jvmTarget = '1.8'
    }
    buildFeatures {
        compose true
    }
    composeOptions {
        kotlinCompilerExtensionVersion '1.2.0'
    }
    packagingOptions {
        resources {
            excludes += '/META-INF/{AL2.0,LGPL2.1}'
        }
    }
    kotlin.sourceSets.all {
        android.applicationVariants.all { variant -> kotlin.srcDir("build/generated/ksp/${variant.name}/kotlin") }
    }
}

dependencies {
    implementation project(':search:search')

    implementation(libs.core.ktx)
    implementation platform(libs.kotlin.bom)

    implementation libs.compose.activity
    implementation libs.compose.ui
    implementation libs.compose.ui.preview
    implementation libs.compose.material

    implementation libs.compose.material.icons

    implementation platform(libs.firebase.bom)
    implementation libs.firebase.firestore
    implementation libs.firebase.storage
    implementation libs.firebase.auth
    implementation libs.firebase.messaging
    implementation libs.firebase.core

    implementation libs.kodein.android
    implementation libs.kodein.conf
    implementation libs.kodein.core

    implementation libs.voyager.navigator
    implementation libs.voyager.bottom.sheet
    implementation libs.voyager.tab
    implementation libs.voyager.transitions
    implementation libs.voyager.androidx
    implementation libs.voyager.kodein
    implementation libs.voyager.livedata

    implementation libs.lyricist
    ksp libs.lyricist.processor

    implementation libs.coroutines.core
    implementation libs.coroutines.android
    implementation libs.coroutines.play

    implementation libs.lifecycle.livedata
    implementation libs.lifecycle.viewmodel
    implementation libs.lifecycle.runtime

    implementation libs.coil

    implementation libs.retrofit
    implementation libs.retrofit.gson

    implementation libs.okhttp.bom
    implementation libs.okhttp
    implementation libs.okhttp.logging

    testImplementation libs.junit
    androidTestImplementation libs.junit.ext
    androidTestImplementation libs.espresso
    androidTestImplementation libs.ui.test
    debugImplementation libs.ui.tooling
    debugImplementation libs.ui.test.manifest
}